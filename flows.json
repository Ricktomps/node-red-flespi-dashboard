[{"id":"0d0307843fdb0387","type":"tab","label":"Flow 1","disabled":false,"info":"","env":[]},{"id":"8264b3fde8d2dd8f","type":"ui_group","name":"Feed Tank Storage","tab":"cb490e472482cd7f","order":2,"disp":true,"width":9,"collapse":false,"className":""},{"id":"745990b60053ed7d","type":"ui_group","name":"Water Tank Storage","tab":"cb490e472482cd7f","order":3,"disp":true,"width":9,"collapse":false,"className":""},{"id":"3eadb1d429bc424e","type":"mqtt-broker","name":"","broker":"mqtt.flespi.io","port":"1883","clientid":"","autoConnect":true,"usetls":false,"protocolVersion":"4","keepalive":"73","cleansession":true,"autoUnsubscribe":true,"birthTopic":"","birthQos":"0","birthRetain":"false","birthPayload":"","birthMsg":{},"closeTopic":"","closeQos":"0","closeRetain":"false","closePayload":"","closeMsg":{},"willTopic":"","willQos":"0","willRetain":"false","willPayload":"","willMsg":{},"userProps":"","sessionExpiry":""},{"id":"92b760d670ff5f11","type":"ui_group","name":"Water Filler","tab":"cb490e472482cd7f","order":4,"disp":true,"width":9,"collapse":false,"className":""},{"id":"078fde0a499aaf5c","type":"ui_group","name":"Feed Bin","tab":"cb490e472482cd7f","order":1,"disp":true,"width":9,"collapse":false,"className":""},{"id":"0129133c0448b399","type":"ui_group","name":"Excel Chart","tab":"26d2b25dc90a57c0","order":2,"disp":true,"width":"30","collapse":false,"className":""},{"id":"cb490e472482cd7f","type":"ui_tab","name":"IOT Enabled Semi-Smart Automated Chiken Feeder and Watering System Utilizing ESP32 Web-based Control and GMS Notifications","icon":"dashboard","order":1,"disabled":false,"hidden":false},{"id":"26d2b25dc90a57c0","type":"ui_tab","name":"Feed Dispensed Logger Excel Chart","icon":"mi-grain","order":2,"disabled":false,"hidden":false},{"id":"7ba096bd80c3a377","type":"ui_base","theme":{"name":"theme-light","lightTheme":{"default":"#0094CE","baseColor":"#0094CE","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"darkTheme":{"default":"#097479","baseColor":"#097479","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":false},"customTheme":{"name":"Untitled Theme 1","default":"#4B7930","baseColor":"#4B7930","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"},"themeState":{"base-color":{"default":"#0094CE","value":"#0094CE","edited":false},"page-titlebar-backgroundColor":{"value":"#0094CE","edited":false},"page-backgroundColor":{"value":"#fafafa","edited":false},"page-sidebar-backgroundColor":{"value":"#ffffff","edited":false},"group-textColor":{"value":"#1bbfff","edited":false},"group-borderColor":{"value":"#ffffff","edited":false},"group-backgroundColor":{"value":"#ffffff","edited":false},"widget-textColor":{"value":"#111111","edited":false},"widget-backgroundColor":{"value":"#0094ce","edited":false},"widget-borderColor":{"value":"#ffffff","edited":false},"base-font":{"value":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"}},"angularTheme":{"primary":"indigo","accents":"blue","warn":"red","background":"grey","palette":"light"}},"site":{"name":"Node-RED Dashboard","hideToolbar":"false","allowSwipe":"false","lockMenu":"false","allowTempTheme":"true","dateFormat":"DD/MM/YYYY","sizes":{"sx":48,"sy":48,"gx":6,"gy":6,"cx":6,"cy":6,"px":0,"py":0}}},{"id":"086e711c02166a64","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"078fde0a499aaf5c","order":1,"width":9,"height":1},{"id":"379f3adc12aca924","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"078fde0a499aaf5c","order":2,"width":9,"height":1},{"id":"38424a816f085f27","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"078fde0a499aaf5c","order":3,"width":1,"height":1},{"id":"87c98cf45c2e1bdc","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"078fde0a499aaf5c","order":5,"width":1,"height":1},{"id":"3448e9b5dc816967","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"078fde0a499aaf5c","order":6,"width":1,"height":1},{"id":"2369f52c0de8c7f5","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"078fde0a499aaf5c","order":7,"width":1,"height":1},{"id":"04e59f8e9d855dbe","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"078fde0a499aaf5c","order":8,"width":1,"height":1},{"id":"d3d866984eefc097","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"078fde0a499aaf5c","order":9,"width":1,"height":1},{"id":"f8c5f2356f34be68","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"078fde0a499aaf5c","order":10,"width":1,"height":1},{"id":"6c4cbb228c9558b5","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"078fde0a499aaf5c","order":11,"width":1,"height":1},{"id":"e20bccc418014881","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"078fde0a499aaf5c","order":12,"width":1,"height":1},{"id":"0a2ed2bb2d8dbcfe","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"078fde0a499aaf5c","order":13,"width":1,"height":1},{"id":"0285ec0a56a21f13","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"078fde0a499aaf5c","order":14,"width":1,"height":1},{"id":"9192686682b734d2","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"078fde0a499aaf5c","order":15,"width":1,"height":1},{"id":"37891facaa7e0d36","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"078fde0a499aaf5c","order":16,"width":1,"height":1},{"id":"dadb5cd677ac335c","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"078fde0a499aaf5c","order":17,"width":1,"height":1},{"id":"3773af89c2e80ece","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"078fde0a499aaf5c","order":18,"width":9,"height":1},{"id":"81214b4d2943f947","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"078fde0a499aaf5c","order":19,"width":1,"height":1},{"id":"3a5b74f4ef47d2cc","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"078fde0a499aaf5c","order":21,"width":1,"height":1},{"id":"cd0769b937c27a88","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"078fde0a499aaf5c","order":22,"width":1,"height":1},{"id":"fbf67badc650ff40","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"078fde0a499aaf5c","order":24,"width":1,"height":1},{"id":"d2ea457e5be3b3e2","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"078fde0a499aaf5c","order":26,"width":1,"height":1},{"id":"3ea0c5d055bf2bce","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"078fde0a499aaf5c","order":27,"width":1,"height":1},{"id":"285636f0fc776f0c","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"078fde0a499aaf5c","order":29,"width":1,"height":1},{"id":"1896ac6e7f519331","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"8264b3fde8d2dd8f","order":1,"width":9,"height":1},{"id":"be37c2f35ab4dfd9","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"8264b3fde8d2dd8f","order":2,"width":9,"height":1},{"id":"97a62d05a09a02c2","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"8264b3fde8d2dd8f","order":3,"width":1,"height":1},{"id":"b3437e144e81ba1c","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"8264b3fde8d2dd8f","order":5,"width":1,"height":1},{"id":"2d632924e92209c1","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"8264b3fde8d2dd8f","order":6,"width":1,"height":1},{"id":"2739b4046cc713f0","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"8264b3fde8d2dd8f","order":7,"width":1,"height":1},{"id":"6eb12fa5825a5abe","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"8264b3fde8d2dd8f","order":8,"width":1,"height":1},{"id":"7fe8abe89f4a9638","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"8264b3fde8d2dd8f","order":9,"width":1,"height":1},{"id":"92bdb32ac588a46c","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"8264b3fde8d2dd8f","order":10,"width":1,"height":1},{"id":"19c098400859ddf0","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"8264b3fde8d2dd8f","order":11,"width":1,"height":1},{"id":"a0d6148ee9f2e56f","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"8264b3fde8d2dd8f","order":12,"width":1,"height":1},{"id":"3e95a5f40dceb1bb","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"8264b3fde8d2dd8f","order":13,"width":1,"height":1},{"id":"dc9d05942a20c80a","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"8264b3fde8d2dd8f","order":14,"width":1,"height":1},{"id":"b086b35acbe0f8ba","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"8264b3fde8d2dd8f","order":15,"width":1,"height":1},{"id":"d7d19f3967bef6a1","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"8264b3fde8d2dd8f","order":16,"width":1,"height":1},{"id":"9744f8e832ac55a8","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"8264b3fde8d2dd8f","order":17,"width":1,"height":1},{"id":"dfcb049a11c85cf4","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"8264b3fde8d2dd8f","order":18,"width":9,"height":1},{"id":"26fdcb1b5c696710","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"8264b3fde8d2dd8f","order":19,"width":1,"height":1},{"id":"b6a1f8cb6e185300","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"8264b3fde8d2dd8f","order":21,"width":1,"height":1},{"id":"bd1b9bc7663f564a","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"8264b3fde8d2dd8f","order":22,"width":1,"height":1},{"id":"b02957afb8274ecf","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"8264b3fde8d2dd8f","order":24,"width":1,"height":1},{"id":"7a1e5e2f5e8e4da0","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"8264b3fde8d2dd8f","order":25,"width":1,"height":1},{"id":"65e756dc1fb197a2","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"8264b3fde8d2dd8f","order":26,"width":1,"height":1},{"id":"f43f3dc526100fce","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"745990b60053ed7d","order":1,"width":9,"height":1},{"id":"5b3725c070cc13d1","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"745990b60053ed7d","order":2,"width":9,"height":1},{"id":"0720d9c03e652ba9","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"745990b60053ed7d","order":3,"width":1,"height":1},{"id":"85ec13797cfbd60d","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"745990b60053ed7d","order":5,"width":1,"height":1},{"id":"03ee549ad97879cd","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"745990b60053ed7d","order":6,"width":1,"height":1},{"id":"e8118585dc5c5ca2","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"745990b60053ed7d","order":7,"width":1,"height":1},{"id":"29833eb3a5a9c5e5","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"745990b60053ed7d","order":8,"width":1,"height":1},{"id":"67148e95dc838732","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"745990b60053ed7d","order":9,"width":1,"height":1},{"id":"70bc984fa33d103d","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"745990b60053ed7d","order":10,"width":1,"height":1},{"id":"505a9fd066158366","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"745990b60053ed7d","order":11,"width":1,"height":1},{"id":"cff8bc323c5b2798","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"745990b60053ed7d","order":12,"width":1,"height":1},{"id":"b495188dc9a269dd","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"745990b60053ed7d","order":13,"width":1,"height":1},{"id":"645d0df87ebaae35","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"745990b60053ed7d","order":14,"width":1,"height":1},{"id":"8be634b324933fc8","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"745990b60053ed7d","order":15,"width":1,"height":1},{"id":"2aa27c93c4ee979b","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"745990b60053ed7d","order":16,"width":1,"height":1},{"id":"bcecf153917c697a","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"745990b60053ed7d","order":17,"width":1,"height":1},{"id":"5b508d954e1d3320","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"745990b60053ed7d","order":18,"width":9,"height":1},{"id":"323a9f6bd80c6ce7","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"745990b60053ed7d","order":19,"width":1,"height":1},{"id":"a0709242a253255f","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"745990b60053ed7d","order":21,"width":1,"height":1},{"id":"f09ceee9d5f14056","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"745990b60053ed7d","order":22,"width":1,"height":1},{"id":"740d65d8d0451da9","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"745990b60053ed7d","order":24,"width":1,"height":1},{"id":"6071dd80fe9d9942","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"745990b60053ed7d","order":25,"width":1,"height":1},{"id":"254c16984ee56170","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"745990b60053ed7d","order":26,"width":1,"height":1},{"id":"65ceab6358c3f0b2","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"92b760d670ff5f11","order":1,"width":9,"height":1},{"id":"950b2e50fc814467","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"92b760d670ff5f11","order":2,"width":9,"height":1},{"id":"f9985717407df7ed","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"92b760d670ff5f11","order":3,"width":1,"height":1},{"id":"fbf357ad0cb43ed5","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"92b760d670ff5f11","order":5,"width":1,"height":1},{"id":"6f5feb8f0db2b12a","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"92b760d670ff5f11","order":6,"width":1,"height":1},{"id":"a9ebc1a5e570a185","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"92b760d670ff5f11","order":7,"width":1,"height":1},{"id":"40f807cf6ba3e8f0","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"92b760d670ff5f11","order":8,"width":1,"height":1},{"id":"533665dd969cf599","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"92b760d670ff5f11","order":9,"width":1,"height":1},{"id":"fe236cdf8210f66d","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"92b760d670ff5f11","order":10,"width":1,"height":1},{"id":"0dc602498379a1e8","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"92b760d670ff5f11","order":11,"width":1,"height":1},{"id":"c9782cfd0d9e3afd","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"92b760d670ff5f11","order":12,"width":1,"height":1},{"id":"6a8d31a01378860a","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"92b760d670ff5f11","order":13,"width":1,"height":1},{"id":"c66b6bc4de42b776","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"92b760d670ff5f11","order":14,"width":1,"height":1},{"id":"af9ff6bbb53b5754","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"92b760d670ff5f11","order":15,"width":1,"height":1},{"id":"e4dc07078ca6236a","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"92b760d670ff5f11","order":16,"width":1,"height":1},{"id":"aa9ba5ad275eb7d3","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"92b760d670ff5f11","order":17,"width":1,"height":1},{"id":"86fd2738ee4df36a","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"92b760d670ff5f11","order":18,"width":9,"height":1},{"id":"22e074d765424447","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"92b760d670ff5f11","order":19,"width":1,"height":1},{"id":"ada7c0914eef532d","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"92b760d670ff5f11","order":21,"width":1,"height":1},{"id":"d90e85d230e86e8f","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"92b760d670ff5f11","order":22,"width":1,"height":1},{"id":"637225dd9bd88ac0","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"92b760d670ff5f11","order":24,"width":1,"height":1},{"id":"6333b91ea440721b","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"92b760d670ff5f11","order":26,"width":1,"height":1},{"id":"7478ca11aea6af10","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"92b760d670ff5f11","order":27,"width":1,"height":1},{"id":"655be74ec43b4fed","type":"ui_spacer","z":"0d0307843fdb0387","name":"spacer","group":"92b760d670ff5f11","order":29,"width":1,"height":1},{"id":"5b1fb9c9ef6450d7","type":"ui_group","name":"System Settings","tab":"3b99b8d87cf753ad","order":1,"disp":true,"width":"20","collapse":false},{"id":"3b99b8d87cf753ad","type":"ui_tab","name":"Settings","icon":"settings","order":6,"disabled":false,"hidden":false},{"id":"063476966f8cfc6f","type":"ui_tab","name":"Water Dispensed Logger Excel Chart","icon":"fa-tint","order":3,"disabled":false,"hidden":false},{"id":"5c7d935d69a4c4d8","type":"ui_tab","name":"SMS for Feed","icon":"fa-envelope","order":4,"disabled":false,"hidden":false},{"id":"8550e8403f94d004","type":"ui_tab","name":"SMS for Water","icon":"fa-envelope","order":5,"disabled":false,"hidden":false},{"id":"6824213245c77df5","type":"ui_group","name":"Water","tab":"063476966f8cfc6f","order":1,"disp":true,"width":30,"collapse":false,"className":""},{"id":"b40693708e85e9cc","type":"ui_group","name":"SMS for Feed","tab":"5c7d935d69a4c4d8","order":1,"disp":true,"width":30,"collapse":false,"className":""},{"id":"40222a887075fa53","type":"ui_group","name":"SMS for Water","tab":"8550e8403f94d004","order":1,"disp":true,"width":30,"collapse":false,"className":""},{"id":"15d5a4a141e1b04e","type":"mqtt in","z":"0d0307843fdb0387","name":"","topic":"sensors/ultrasonic","qos":"0","datatype":"json","broker":"3eadb1d429bc424e","nl":false,"rap":false,"inputs":0,"x":470,"y":480,"wires":[["9720bf925d2b2928"]]},{"id":"9720bf925d2b2928","type":"function","z":"0d0307843fdb0387","name":"Split Sensors","func":"return [\n  { payload: msg.payload.sensor_1 },\n  { payload: msg.payload.sensor_2 },\n  { payload: msg.payload.sensor_3 }\n];","outputs":3,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":650,"y":480,"wires":[["601d418eb251d5cf"],["a3f0eae4e567b191"],["e532cde7f1a43152"]]},{"id":"e532cde7f1a43152","type":"ui_gauge","z":"0d0307843fdb0387","name":"","group":"745990b60053ed7d","order":4,"width":7,"height":7,"gtype":"wave","title":"Water Tank Storage","label":"cm","format":"{{value}}","min":"0","max":"15","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","diff":false,"className":"","x":870,"y":520,"wires":[]},{"id":"a3f0eae4e567b191","type":"ui_gauge","z":"0d0307843fdb0387","name":"","group":"8264b3fde8d2dd8f","order":4,"width":7,"height":7,"gtype":"gage","title":"Feed Tank Storage","label":"cm","format":"{{value}}","min":"0","max":"15","colors":["#b30000","#e6e600","#00b500"],"seg1":"","seg2":"","diff":false,"className":"","x":890,"y":480,"wires":[]},{"id":"601d418eb251d5cf","type":"ui_gauge","z":"0d0307843fdb0387","name":"","group":"92b760d670ff5f11","order":4,"width":7,"height":7,"gtype":"wave","title":"Water Filler","label":"cm","format":"{{value}}","min":"0","max":"15","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","diff":false,"className":"","x":890,"y":440,"wires":[]},{"id":"bba31deabb9e2b79","type":"ui_button","z":"0d0307843fdb0387","name":"Pump ON","group":"92b760d670ff5f11","order":25,"width":3,"height":1,"passthru":false,"label":"Pump ON","tooltip":"","color":"","bgcolor":"","className":"","icon":"","payload":"ON","payloadType":"str","topic":"pump/control","topicType":"str","x":460,"y":660,"wires":[["d68d02aad805784d","826eec0b316b3892"]]},{"id":"60a968c418b4052b","type":"ui_button","z":"0d0307843fdb0387","name":"Pump OFF","group":"92b760d670ff5f11","order":23,"width":3,"height":1,"label":"Pump OFF","payload":"OFF","payloadType":"str","topic":"pump/control","x":460,"y":720,"wires":[["d68d02aad805784d","826eec0b316b3892"]]},{"id":"d68d02aad805784d","type":"mqtt out","z":"0d0307843fdb0387","name":"","topic":"pump/control","qos":"2","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"3eadb1d429bc424e","x":890,"y":720,"wires":[]},{"id":"8c1147de50375498","type":"ui_text","z":"0d0307843fdb0387","group":"92b760d670ff5f11","order":20,"width":7,"height":1,"label":"Water Pump Switch","format":"{{msg.payload}}","x":610,"y":600,"wires":[]},{"id":"826eec0b316b3892","type":"ui_text","z":"0d0307843fdb0387","group":"92b760d670ff5f11","order":28,"width":7,"height":1,"label":"Indicator","format":"{{msg.payload}}","x":740,"y":800,"wires":[]},{"id":"f1913d41fa3b79b0","type":"mqtt in","z":"0d0307843fdb0387","name":"","topic":"sensors/weight_remote","qos":"2","datatype":"auto-detect","broker":"3eadb1d429bc424e","nl":false,"rap":true,"rh":0,"inputs":0,"x":670,"y":60,"wires":[["96b3e5f5964dfebf"]]},{"id":"96b3e5f5964dfebf","type":"ui_gauge","z":"0d0307843fdb0387","name":"","group":"078fde0a499aaf5c","order":4,"width":7,"height":7,"gtype":"gage","title":"Feed Bin","label":"g","format":"{{value}}","min":0,"max":"0.500","colors":["#b30000","#e6e600","#00b500"],"seg1":"","seg2":"","diff":false,"className":"","x":920,"y":80,"wires":[]},{"id":"641dca135d9776d7","type":"ui_button","z":"0d0307843fdb0387","name":"Move 0","group":"078fde0a499aaf5c","order":23,"width":3,"height":1,"label":"SERVO OFF","payload":"0","payloadType":"str","topic":"servo/control","x":890,"y":200,"wires":[["d7c3f0e29edd71d6","1bd5f2fa65c6f2d4"]]},{"id":"70ed18e8e3eb1d0c","type":"ui_button","z":"0d0307843fdb0387","name":"Move 180","group":"078fde0a499aaf5c","order":25,"width":3,"height":1,"passthru":false,"label":"SERVO ON","tooltip":"","color":"","bgcolor":"","className":"","icon":"","payload":"180","payloadType":"str","topic":"servo/control","topicType":"str","x":890,"y":260,"wires":[["d7c3f0e29edd71d6","1bd5f2fa65c6f2d4"]]},{"id":"d7c3f0e29edd71d6","type":"mqtt out","z":"0d0307843fdb0387","name":"","topic":"servo/control","qos":"2","retain":"true","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"3eadb1d429bc424e","x":1140,"y":240,"wires":[]},{"id":"1bd5f2fa65c6f2d4","type":"ui_text","z":"0d0307843fdb0387","group":"078fde0a499aaf5c","order":28,"width":7,"height":1,"name":"","label":"Indicator","format":"{{msg.payload}}","layout":"","className":"","style":false,"font":"","fontSize":"","color":"#000000","x":1130,"y":320,"wires":[]},{"id":"ec22629b3ae12e88","type":"ui_text","z":"0d0307843fdb0387","group":"078fde0a499aaf5c","order":20,"width":7,"height":1,"label":"Servo Switch","format":"{{msg.payload}}","x":1100,"y":180,"wires":[]},{"id":"0a2b9a22b5c8dfbe","type":"ui_template","z":"0d0307843fdb0387","group":"0129133c0448b399","name":"ThingSpeak Button","order":1,"width":30,"height":21,"format":"<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <title>Food Dispensed Chart</title>\n  <style>\n    html,\n    body {\n      height: 100%;\n      margin: 0;\n      padding: 0;\n      font-family: Arial, sans-serif;\n      background: #f8f9fa;\n    }\n\n    h2,\n    h3 {\n      margin: 10px 0;\n      text-align: center;\n      color: #333;\n    }\n\n    .charts-container {\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      gap: 50px;\n      padding: 20px;\n      width: 100%;\n    }\n\n    .chart-wrapper {\n      width: 100%;\n      max-width: 900px;\n      height: 450px;\n      background: #fff;\n      border-radius: 12px;\n      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n      padding: 15px;\n    }\n\n    .btn-container {\n      text-align: center;\n      margin: 20px 0;\n    }\n\n    .btn-link {\n      background-color: #28a745;\n      color: white;\n      border: none;\n      padding: 10px 20px;\n      font-size: 16px;\n      cursor: pointer;\n      border-radius: 5px;\n      text-decoration: none;\n    }\n\n    .btn-link:hover {\n      background-color: #218838;\n    }\n  </style>\n  <script src=\"https://cdn.jsdelivr.net/npm/chart.js\"></script>\n</head>\n\n<body>\n  <h2>Food Dispensed Logger</h2>\n\n  <div class=\"btn-container\">\n    <a class=\"btn-link\" href=\"https://thingspeak.mathworks.com/channels/3012156\" target=\"_blank\">\n      Open Excel Chart\n    </a>\n  </div>\n\n  <div class=\"charts-container\">\n    <div>\n      <h3>Food Dispensed Amount (g)</h3>\n      <div class=\"chart-wrapper\">\n        <canvas id=\"foodChart\"></canvas>\n      </div>\n    </div>\n  </div>\n\n  <script>\n    async function fetchThingSpeakData() {\n      const url = \"https://api.thingspeak.com/channels/3012156/feeds.json?api_key=0VDAPPHULHOO693A&results=100\";\n      try {\n        const response = await fetch(url);\n        const data = await response.json();\n        const labels = [];\n        const foodValues = [];\n\n        data.feeds.forEach(feed => {\n          const label = new Date(feed.created_at).toLocaleDateString();\n          const food = Number(feed.field2);\n          labels.push(label);\n          // replace 0 with null to skip plotting\n          foodValues.push(food === 0 ? null : food);\n        });\n\n        return { labels, foodValues };\n      } catch (err) {\n        console.error(\"HTTP Request Failed:\", err);\n        return { labels: [], foodValues: [] };\n      }\n    }\n\n    async function renderCharts() {\n      const { labels, foodValues } = await fetchThingSpeakData();\n\n      // Destroy existing chart if it exists to prevent overlap on refresh\n      const ctx = document.getElementById(\"foodChart\").getContext(\"2d\");\n      if (window.foodChartInstance) window.foodChartInstance.destroy();\n\n      window.foodChartInstance = new Chart(ctx, {\n        type: \"line\",\n        data: {\n          labels: labels,\n          datasets: [{\n            label: \"Food Dispensed Amount (g)\",\n            data: foodValues,\n            borderColor: \"#FF5733\",\n            backgroundColor: \"rgba(255,87,51,0.2)\",\n            fill: true,\n            tension: 0.4,\n            spanGaps: true,\n            pointRadius: 4,\n            pointHoverRadius: 6\n          }]\n        },\n        options: {\n          responsive: true,\n          maintainAspectRatio: false,\n          plugins: {\n            tooltip: {\n              callbacks: { label: (ctx) => ctx.raw ? `${ctx.raw} g on ${ctx.label}` : null }\n            },\n            legend: { labels: { color: \"#333\" } }\n          },\n          scales: {\n            x: { title: { display: true, text: \"Date\", color: \"#555\" }, grid: { color: \"#eee\" } },\n            y: { title: { display: true, text: \"Value (g)\", color: \"#555\" }, grid: { color: \"#eee\" } }\n          }\n        }\n      });\n    }\n\n    renderCharts();\n    setInterval(renderCharts, 30000);\n  </script>\n</body>\n\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":930,"y":860,"wires":[[]]},{"id":"76653bb793aa4e06","type":"mqtt in","z":"0d0307843fdb0387","name":"","topic":"notif/food","qos":"2","datatype":"auto-detect","broker":"3eadb1d429bc424e","nl":false,"rap":true,"rh":0,"inputs":0,"x":1080,"y":580,"wires":[["9e5363fe0e19bd75"]]},{"id":"72da6cdf30bcac40","type":"mqtt in","z":"0d0307843fdb0387","name":"","topic":"notif/water","qos":"2","datatype":"auto-detect","broker":"3eadb1d429bc424e","nl":false,"rap":true,"rh":0,"inputs":0,"x":1100,"y":640,"wires":[["7ce1d452fe398114"]]},{"id":"9e5363fe0e19bd75","type":"ui_text","z":"0d0307843fdb0387","group":"8264b3fde8d2dd8f","order":23,"width":7,"height":2,"name":"","label":"","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Arial Black,Arial Black,Gadget,sans-serif","fontSize":"20","color":"#000000","x":1230,"y":580,"wires":[]},{"id":"7ce1d452fe398114","type":"ui_text","z":"0d0307843fdb0387","group":"745990b60053ed7d","order":23,"width":7,"height":2,"name":"","label":"","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Arial Black,Arial Black,Gadget,sans-serif","fontSize":"20","color":"#000000","x":1250,"y":640,"wires":[]},{"id":"abf25890a6bd8dd9","type":"ui_text","z":"0d0307843fdb0387","group":"8264b3fde8d2dd8f","order":20,"width":7,"height":1,"name":"","label":"Notifications:","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Arial Black,Arial Black,Gadget,sans-serif","fontSize":"20","color":"#000000","x":1150,"y":760,"wires":[]},{"id":"df475308b89e8f86","type":"ui_text","z":"0d0307843fdb0387","group":"745990b60053ed7d","order":20,"width":7,"height":1,"name":"","label":"Notifications:","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Arial Black,Arial Black,Gadget,sans-serif","fontSize":"20","color":"#000000","x":1150,"y":720,"wires":[]},{"id":"247be521bca3de26","type":"mqtt in","z":"0d0307843fdb0387","name":"","topic":"servo/state","qos":"2","datatype":"auto-detect","broker":"3eadb1d429bc424e","nl":false,"rap":true,"rh":0,"inputs":0,"x":900,"y":340,"wires":[["1bd5f2fa65c6f2d4"]]},{"id":"27e206f9903e091b","type":"mqtt in","z":"0d0307843fdb0387","name":"","topic":"pump/state","qos":"2","datatype":"auto-detect","broker":"3eadb1d429bc424e","nl":false,"rap":true,"rh":0,"inputs":0,"x":500,"y":840,"wires":[["826eec0b316b3892"]]},{"id":"cf744bc4ec9b97de","type":"ui_template","z":"0d0307843fdb0387","group":"5b1fb9c9ef6450d7","name":"Enhanced Settings Panel","order":1,"width":"20","height":"14","format":"<style>\n    :root {\n        --nr-dashboard-pageTitlebarBackgroundColor: #333;\n        --success-color: #28a745;\n        --cancel-color: #6c757d;\n    }\n\n    .settings-container {\n        font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Helvetica, Arial, sans-serif;\n        padding: 10px;\n    }\n\n    .setting-card {\n        background: var(--nr-dashboard-groupBgColor);\n        border: 1px solid var(--nr-dashboard-pageTitlebarBackgroundColor);\n        border-radius: 8px;\n        padding: 15px;\n        margin-bottom: 15px;\n        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);\n    }\n\n    .setting-header {\n        display: flex;\n        align-items: center;\n        gap: 10px;\n        font-weight: bold;\n        font-size: 1.1em;\n        color: var(--nr-dashboard-widgetColor);\n        border-bottom: 1px solid rgba(0, 0, 0, 0.1);\n        padding-bottom: 8px;\n        margin-bottom: 10px;\n    }\n\n    .input-row {\n        display: flex;\n        gap: 10px;\n        width: 100%;\n    }\n\n    .custom-input {\n        width: 100%;\n        padding: 10px;\n        border: 1px solid #ccc;\n        border-radius: 5px;\n        font-size: 16px;\n        color: #333;\n    }\n\n    .phone-wrapper {\n        display: flex;\n        width: 100%;\n    }\n\n    .phone-prefix {\n        background-color: #e9ecef;\n        border: 1px solid #ccc;\n        border-right: none;\n        color: #495057;\n        padding: 10px;\n        border-top-left-radius: 5px;\n        border-bottom-left-radius: 5px;\n        display: flex;\n        align-items: center;\n        font-weight: bold;\n    }\n\n    .phone-wrapper .custom-input {\n        border-top-left-radius: 0;\n        border-bottom-left-radius: 0;\n    }\n\n    .action-row {\n        display: flex;\n        gap: 15px;\n        margin-top: 20px;\n        justify-content: flex-end;\n    }\n\n    .btn {\n        padding: 12px 24px;\n        border: none;\n        border-radius: 5px;\n        cursor: pointer;\n        font-weight: bold;\n        color: white;\n        flex: 1;\n    }\n\n    .btn-save {\n        background-color: var(--success-color);\n    }\n\n    .btn-cancel {\n        background-color: var(--cancel-color);\n    }\n\n    .success-toast {\n        background-color: #d4edda;\n        color: #155724;\n        padding: 15px;\n        border-radius: 5px;\n        text-align: center;\n        margin-top: 15px;\n        opacity: 0;\n        transition: opacity 0.5s;\n    }\n\n    .success-toast.visible {\n        opacity: 1;\n    }\n</style>\n\n<div class=\"settings-container\">\n\n    <div class=\"setting-card\">\n        <div class=\"setting-header\">\n            <i class=\"fa fa-sun-o\"></i> Morning Schedule\n        </div>\n        <div class=\"input-row\">\n            <input type=\"time\" class=\"custom-input\" ng-model=\"sched1\">\n        </div>\n    </div>\n\n    <div class=\"setting-card\">\n        <div class=\"setting-header\">\n            <i class=\"fa fa-moon-o\"></i> Afternoon Schedule\n        </div>\n        <div class=\"input-row\">\n            <input type=\"time\" class=\"custom-input\" ng-model=\"sched2\">\n        </div>\n    </div>\n\n    <div class=\"setting-card\">\n        <div class=\"setting-header\">\n            <i class=\"fa fa-balance-scale\"></i> Max Food Weight (g)\n        </div>\n        <div class=\"input-row\">\n            <input type=\"number\" class=\"custom-input\" ng-model=\"threshold\" placeholder=\"300\">\n        </div>\n    </div>\n\n    <div class=\"setting-card\">\n        <div class=\"setting-header\">\n            <i class=\"fa fa-mobile\"></i> Notification Phone\n        </div>\n        <div class=\"input-row\">\n            <div class=\"phone-wrapper\">\n                <span class=\"phone-prefix\">+63</span>\n                <input id=\"phoneInput\" type=\"text\" class=\"custom-input\" ng-model=\"phone\" placeholder=\"9xxxxxxxxx\" maxlength=\"10\">\n            </div>\n        </div>\n    </div>\n\n    <div class=\"action-row\">\n        <button class=\"btn btn-cancel\" ng-click=\"cancel()\">Cancel</button>\n        <button class=\"btn btn-save\" ng-click=\"saveAll()\">Save Changes</button>\n    </div>\n\n    <div class=\"success-toast\" ng-class=\"{'visible': showSuccess}\">\n        <i class=\"fa fa-check-circle\"></i> Settings Saved!\n    </div>\n\n</div>\n\n<script>\n    (function(scope) {\n    \n    // Helper: Convert \"HH:mm\" string to Date object for input[type=time]\n    function stringToDate(timeStr) {\n        if (!timeStr) return null;\n        var d = new Date();\n        var parts = timeStr.split(':');\n        d.setHours(parseInt(parts[0]));\n        d.setMinutes(parseInt(parts[1]));\n        d.setSeconds(0);\n        return d;\n    }\n\n    // 1. LISTEN: Update UI when MQTT message arrives\n    scope.$watch('msg', function(msg) {\n        if (!msg) return;\n        \n        if (msg.topic === 'settings/schedule1') {\n            scope.sched1 = stringToDate(msg.payload);\n        }\n        if (msg.topic === 'settings/schedule2') {\n            scope.sched2 = stringToDate(msg.payload);\n        }\n        if (msg.topic === 'settings/threshold') {\n            scope.threshold = parseInt(msg.payload);\n        }\n        \n        if (msg.topic === 'settings/phone') {\n            // FIX: Check if user is currently typing in the box\n            var activeElement = document.activeElement;\n            var isPhoneFocused = (activeElement && activeElement.id === 'phoneInput');\n\n            // Only update the phone number from the server if the user is NOT typing\n            if (!isPhoneFocused) {\n                var p = msg.payload.toString();\n                // Remove +63, 63, or leading 0 to keep format clean\n                scope.phone = p.replace(/^\\+63|^63|^0/, \"\"); \n            }\n        }\n    });\n\n    // 2. SAVE: Gather data and send\n    scope.saveAll = function() {\n        var payload = {};\n        \n        // Convert Date objects back to \"HH:mm\" strings\n        if (scope.sched1) {\n            var h = ('0' + scope.sched1.getHours()).slice(-2);\n            var m = ('0' + scope.sched1.getMinutes()).slice(-2);\n            payload['settings/schedule1'] = h + ':' + m;\n        }\n        \n        if (scope.sched2) {\n            var h = ('0' + scope.sched2.getHours()).slice(-2);\n            var m = ('0' + scope.sched2.getMinutes()).slice(-2);\n            payload['settings/schedule2'] = h + ':' + m;\n        }\n        \n        if (scope.threshold) {\n            payload['settings/threshold'] = scope.threshold;\n        }\n        \n        if (scope.phone) {\n            // Ensure we don't double add +63\n            var cleanPhone = scope.phone.toString().replace(/^\\+63|^63|^0/, \"\");\n            payload['settings/phone'] = \"+63\" + cleanPhone;\n        }\n\n        // Send the Object to the Flow\n        scope.send({ payload: payload });\n\n        // Animation\n        scope.showSuccess = true;\n        setTimeout(function() { \n            scope.showSuccess = false; \n            scope.$apply(); \n        }, 3000);\n    };\n\n    // 3. CANCEL: Clear inputs\n    scope.cancel = function() {\n        scope.sched1 = null;\n        scope.sched2 = null;\n        scope.threshold = null;\n        scope.phone = \"\"; // Reset to empty string\n    };\n\n})(scope);\n</script>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":730,"y":1120,"wires":[["fc1d9b4a03b2fd29"]]},{"id":"fc1d9b4a03b2fd29","type":"function","z":"0d0307843fdb0387","name":"Format & Split Messages","func":"// Takes the single object from UI and splits it \n// into individual MQTT messages\n\nvar updates = [];\nvar data = msg.payload;\n\n// Loop through keys (e.g., settings/schedule1)\nfor (var key in data) {\n    if (data.hasOwnProperty(key)) {\n        updates.push({\n            topic: key,\n            payload: data[key]\n        });\n    }\n}\n\n// Return array of messages (Node-RED sends them sequentially)\nreturn [updates];","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":990,"y":1120,"wires":[["80624433974a3a33"]]},{"id":"80624433974a3a33","type":"mqtt out","z":"0d0307843fdb0387","name":"Publish Settings","topic":"","qos":"","retain":"","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"3eadb1d429bc424e","x":1220,"y":1120,"wires":[]},{"id":"1c580a730834da17","type":"mqtt in","z":"0d0307843fdb0387","name":"","topic":"settings/schedule1","qos":"2","datatype":"auto-detect","broker":"3eadb1d429bc424e","nl":false,"rap":true,"rh":0,"inputs":0,"x":430,"y":1040,"wires":[["cf744bc4ec9b97de"]]},{"id":"afe51652f55785a9","type":"mqtt in","z":"0d0307843fdb0387","name":"","topic":"settings/schedule2","qos":"2","datatype":"auto-detect","broker":"3eadb1d429bc424e","nl":false,"rap":true,"rh":0,"inputs":0,"x":430,"y":1080,"wires":[["cf744bc4ec9b97de"]]},{"id":"f41180a1abf81019","type":"mqtt in","z":"0d0307843fdb0387","name":"","topic":"settings/threshold","qos":"2","datatype":"auto-detect","broker":"3eadb1d429bc424e","nl":false,"rap":true,"rh":0,"inputs":0,"x":430,"y":1120,"wires":[["cf744bc4ec9b97de"]]},{"id":"5c67ab9ec2abb54a","type":"mqtt in","z":"0d0307843fdb0387","name":"","topic":"settings/phone","qos":"2","datatype":"auto-detect","broker":"3eadb1d429bc424e","nl":false,"rap":true,"rh":0,"inputs":0,"x":430,"y":1160,"wires":[["cf744bc4ec9b97de"]]},{"id":"1d5cb0178026c673","type":"ui_template","z":"0d0307843fdb0387","group":"6824213245c77df5","name":"ThingSpeak Button1","order":1,"width":30,"height":20,"format":"<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <title>Water Dispensed Chart</title>\n  <style>\n    html,\n    body {\n      height: 100%;\n      margin: 0;\n      padding: 0;\n      font-family: Arial, sans-serif;\n      background: #f8f9fa;\n    }\n\n    h2,\n    h3 {\n      margin: 10px 0;\n      text-align: center;\n      color: #333;\n    }\n\n    .charts-container {\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      gap: 50px;\n      padding: 20px;\n      width: 100%;\n    }\n\n    .chart-wrapper {\n      width: 100%;\n      max-width: 900px;\n      height: 450px;\n      background: #fff;\n      border-radius: 12px;\n      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n      padding: 15px;\n    }\n\n    .btn-container {\n      text-align: center;\n      margin: 20px 0;\n    }\n\n    .btn-link {\n      background-color: #28a745;\n      color: white;\n      border: none;\n      padding: 10px 20px;\n      font-size: 16px;\n      cursor: pointer;\n      border-radius: 5px;\n      text-decoration: none;\n    }\n\n    .btn-link:hover {\n      background-color: #218838;\n    }\n  </style>\n  <script src=\"https://cdn.jsdelivr.net/npm/chart.js\"></script>\n</head>\n\n<body>\n  <h2>Water Dispensed Logger</h2>\n\n  <div class=\"btn-container\">\n    <a class=\"btn-link\" href=\"https://thingspeak.mathworks.com/channels/3012156\" target=\"_blank\">\n      Open Excel Chart\n    </a>\n  </div>\n\n  <div class=\"charts-container\">\n    <div>\n      <h3>Water Dispensed Amount (cm)</h3>\n      <div class=\"chart-wrapper\">\n        <canvas id=\"waterChart\"></canvas>\n      </div>\n    </div>\n  </div>\n\n  <script>\n    async function fetchThingSpeakData() {\n      const url = \"https://api.thingspeak.com/channels/3012156/feeds.json?api_key=0VDAPPHULHOO693A&results=100\";\n      try {\n        const response = await fetch(url);\n        const data = await response.json();\n        const labels = [];\n        const waterValues = [];\n\n        data.feeds.forEach(feed => {\n          const label = new Date(feed.created_at).toLocaleDateString();\n          const water = Number(feed.field1);\n          labels.push(label);\n          // replace 0 with null to skip plotting\n          waterValues.push(water === 0 ? null : water);\n        });\n\n        return { labels, waterValues };\n      } catch (err) {\n        console.error(\"HTTP Request Failed:\", err);\n        return { labels: [], waterValues: [] };\n      }\n    }\n\n    async function renderCharts() {\n      const { labels, waterValues } = await fetchThingSpeakData();\n\n      // Destroy existing chart if it exists to prevent overlap on refresh\n      const ctx = document.getElementById(\"waterChart\").getContext(\"2d\");\n      if (window.waterChartInstance) window.waterChartInstance.destroy();\n\n      window.waterChartInstance = new Chart(ctx, {\n        type: \"line\",\n        data: {\n          labels: labels,\n          datasets: [{\n            label: \"Water Dispensed Amount (cm)\",\n            data: waterValues,\n            borderColor: \"#007BFF\",\n            backgroundColor: \"rgba(0,123,255,0.2)\",\n            fill: true,\n            tension: 0.4,\n            spanGaps: true,\n            pointRadius: 4,\n            pointHoverRadius: 6\n          }]\n        },\n        options: {\n          responsive: true,\n          maintainAspectRatio: false,\n          plugins: {\n            tooltip: {\n              callbacks: { label: (ctx) => ctx.raw ? `${ctx.raw} cm on ${ctx.label}` : null }\n            },\n            legend: { labels: { color: \"#333\" } }\n          },\n          scales: {\n            x: { title: { display: true, text: \"Date\", color: \"#555\" }, grid: { color: \"#eee\" } },\n            y: { title: { display: true, text: \"Value (cm)\", color: \"#555\" }, grid: { color: \"#eee\" } }\n          }\n        }\n      });\n    }\n\n    renderCharts();\n    setInterval(renderCharts, 30000);\n  </script>\n</body>\n\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":1160,"y":860,"wires":[[]]},{"id":"af3e9d4d7f354f9c","type":"ui_template","z":"0d0307843fdb0387","group":"b40693708e85e9cc","name":"ThingSpeak Button2","order":1,"width":30,"height":19,"format":"<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <title>Food SMS Notification Chart</title>\n  <style>\n    html,\n    body {\n      height: 100%;\n      margin: 0;\n      padding: 0;\n      font-family: Arial, sans-serif;\n      background: #f8f9fa;\n    }\n\n    h2,\n    h3 {\n      margin: 10px 0;\n      text-align: center;\n      color: #333;\n    }\n\n    .charts-container {\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      gap: 50px;\n      padding: 20px;\n      width: 100%;\n    }\n\n    .chart-wrapper {\n      width: 100%;\n      max-width: 900px;\n      height: 450px;\n      background: #fff;\n      border-radius: 12px;\n      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n      padding: 15px;\n    }\n\n    .btn-container {\n      text-align: center;\n      margin: 20px 0;\n    }\n\n    .btn-link {\n      background-color: #28a745;\n      color: white;\n      border: none;\n      padding: 10px 20px;\n      font-size: 16px;\n      cursor: pointer;\n      border-radius: 5px;\n      text-decoration: none;\n    }\n\n    .btn-link:hover {\n      background-color: #218838;\n    }\n  </style>\n  <script src=\"https://cdn.jsdelivr.net/npm/chart.js\"></script>\n</head>\n\n<body>\n  <h2>Food Tank SMS Logger</h2>\n\n  <div class=\"btn-container\">\n    <a class=\"btn-link\" href=\"https://thingspeak.mathworks.com/channels/3012156\" target=\"_blank\">\n      Open Excel Chart\n    </a>\n  </div>\n\n  <div class=\"charts-container\">\n    <div>\n      <h3>Food Level at SMS Alert (cm)</h3>\n      <div class=\"chart-wrapper\">\n        <canvas id=\"feedAlertChart\"></canvas>\n      </div>\n    </div>\n  </div>\n\n  <script>\n    async function fetchThingSpeakData() {\n      // Fetching from Field 3\n      const url = \"https://api.thingspeak.com/channels/3012156/feeds.json?api_key=0VDAPPHULHOO693A&results=100\";\n      try {\n        const response = await fetch(url);\n        const data = await response.json();\n        const labels = [];\n        const alertValues = [];\n\n        data.feeds.forEach(feed => {\n          const label = new Date(feed.created_at).toLocaleDateString();\n          // Field 3 corresponds to Feed SMS data\n          const val = Number(feed.field3);\n          labels.push(label);\n          // replace 0 with null to skip plotting\n          alertValues.push(val === 0 ? null : val);\n        });\n\n        return { labels, alertValues };\n      } catch (err) {\n        console.error(\"HTTP Request Failed:\", err);\n        return { labels: [], alertValues: [] };\n      }\n    }\n\n    async function renderCharts() {\n      const { labels, alertValues } = await fetchThingSpeakData();\n\n      const ctx = document.getElementById(\"feedAlertChart\").getContext(\"2d\");\n      if (window.feedAlertChartInstance) window.feedAlertChartInstance.destroy();\n\n      window.feedAlertChartInstance = new Chart(ctx, {\n        type: \"line\",\n        data: {\n          labels: labels,\n          datasets: [{\n            label: \"Food Tank Level (cm)\",\n            data: alertValues,\n            // Orange/Red color to signify Feed/Alert\n            borderColor: \"#FF5733\",\n            backgroundColor: \"rgba(255, 87, 51, 0.2)\",\n            fill: true,\n            tension: 0.4,\n            spanGaps: true,\n            pointRadius: 4,\n            pointHoverRadius: 6\n          }]\n        },\n        options: {\n          responsive: true,\n          maintainAspectRatio: false,\n          plugins: {\n            tooltip: {\n              callbacks: { label: (ctx) => ctx.raw ? `${ctx.raw} cm on ${ctx.label}` : null }\n            },\n            legend: { labels: { color: \"#333\" } }\n          },\n          scales: {\n            x: { title: { display: true, text: \"Date\", color: \"#555\" }, grid: { color: \"#eee\" } },\n            y: { title: { display: true, text: \"Level (cm)\", color: \"#555\" }, grid: { color: \"#eee\" } }\n          }\n        }\n      });\n    }\n\n    renderCharts();\n    setInterval(renderCharts, 30000);\n  </script>\n</body>\n\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":940,"y":900,"wires":[[]]},{"id":"45ad17bc7fe565eb","type":"ui_template","z":"0d0307843fdb0387","group":"40222a887075fa53","name":"ThingSpeak Button3","order":1,"width":30,"height":19,"format":"<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <title>Water SMS Notification Chart</title>\n  <style>\n    html,\n    body {\n      height: 100%;\n      margin: 0;\n      padding: 0;\n      font-family: Arial, sans-serif;\n      background: #f8f9fa;\n    }\n\n    h2,\n    h3 {\n      margin: 10px 0;\n      text-align: center;\n      color: #333;\n    }\n\n    .charts-container {\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      gap: 50px;\n      padding: 20px;\n      width: 100%;\n    }\n\n    .chart-wrapper {\n      width: 100%;\n      max-width: 900px;\n      height: 450px;\n      background: #fff;\n      border-radius: 12px;\n      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n      padding: 15px;\n    }\n\n    .btn-container {\n      text-align: center;\n      margin: 20px 0;\n    }\n\n    .btn-link {\n      background-color: #28a745;\n      color: white;\n      border: none;\n      padding: 10px 20px;\n      font-size: 16px;\n      cursor: pointer;\n      border-radius: 5px;\n      text-decoration: none;\n    }\n\n    .btn-link:hover {\n      background-color: #218838;\n    }\n  </style>\n  <script src=\"https://cdn.jsdelivr.net/npm/chart.js\"></script>\n</head>\n\n<body>\n  <h2>Water Tank SMS Logger</h2>\n\n  <div class=\"btn-container\">\n    <a class=\"btn-link\" href=\"https://thingspeak.mathworks.com/channels/3012156\" target=\"_blank\">\n      Open Excel Chart\n    </a>\n  </div>\n\n  <div class=\"charts-container\">\n    <div>\n      <h3>Water Level at SMS Alert (cm)</h3>\n      <div class=\"chart-wrapper\">\n        <canvas id=\"waterAlertChart\"></canvas>\n      </div>\n    </div>\n  </div>\n\n  <script>\n    async function fetchThingSpeakData() {\n      // Fetching from Field 4\n      const url = \"https://api.thingspeak.com/channels/3012156/feeds.json?api_key=0VDAPPHULHOO693A&results=100\";\n      try {\n        const response = await fetch(url);\n        const data = await response.json();\n        const labels = [];\n        const alertValues = [];\n\n        data.feeds.forEach(feed => {\n          const label = new Date(feed.created_at).toLocaleDateString();\n          // Field 4 corresponds to Water SMS data\n          const val = Number(feed.field4);\n          labels.push(label);\n          // replace 0 with null to skip plotting\n          alertValues.push(val === 0 ? null : val);\n        });\n\n        return { labels, alertValues };\n      } catch (err) {\n        console.error(\"HTTP Request Failed:\", err);\n        return { labels: [], alertValues: [] };\n      }\n    }\n\n    async function renderCharts() {\n      const { labels, alertValues } = await fetchThingSpeakData();\n\n      const ctx = document.getElementById(\"waterAlertChart\").getContext(\"2d\");\n      if (window.waterAlertChartInstance) window.waterAlertChartInstance.destroy();\n\n      window.waterAlertChartInstance = new Chart(ctx, {\n        type: \"line\",\n        data: {\n          labels: labels,\n          datasets: [{\n            label: \"Water Tank Level (cm)\",\n            data: alertValues,\n            // Blue color to signify Water\n            borderColor: \"#007BFF\",\n            backgroundColor: \"rgba(0, 123, 255, 0.2)\",\n            fill: true,\n            tension: 0.4,\n            spanGaps: true,\n            pointRadius: 4,\n            pointHoverRadius: 6\n          }]\n        },\n        options: {\n          responsive: true,\n          maintainAspectRatio: false,\n          plugins: {\n            tooltip: {\n              callbacks: { label: (ctx) => ctx.raw ? `${ctx.raw} cm on ${ctx.label}` : null }\n            },\n            legend: { labels: { color: \"#333\" } }\n          },\n          scales: {\n            x: { title: { display: true, text: \"Date\", color: \"#555\" }, grid: { color: \"#eee\" } },\n            y: { title: { display: true, text: \"Level (cm)\", color: \"#555\" }, grid: { color: \"#eee\" } }\n          }\n        }\n      });\n    }\n\n    renderCharts();\n    setInterval(renderCharts, 30000);\n  </script>\n</body>\n\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":1160,"y":900,"wires":[[]]}]
